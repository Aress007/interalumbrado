<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Panel Admin - Interalumbrado</title>
  <link rel="stylesheet" href="style/style.css">
  <style>
    .admin-container { max-width: 1200px; margin: 0 auto; padding: 20px; }
    .admin-header { background: #003366; color: white; padding: 20px; border-radius: 10px; margin-bottom: 20px; }
    .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 30px; }
    .stat-card { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); text-align: center; }
    .stat-number { font-size: 2rem; font-weight: bold; color: #003366; }
    #solicitudes-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    #solicitudes-table th { background: #003366; color: white; padding: 12px; text-align: left; }
    #solicitudes-table td { padding: 10px; border-bottom: 1px solid #ddd; }
    .ticket-badge { background: #0051a2; color: white; padding: 3px 8px; border-radius: 4px; font-size: 0.9rem; }
    .btn-refresh { background: #28a745; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="header-inner">
      <div class="brand">
        <img src="img/Logo.jpg" alt="Logo" class="logo">
        <div class="brand-text">
          <h1>Panel de AdministraciÃ³n</h1>
          <p class="tagline">Consorcio Interalumbrado de CÃºcuta</p>
        </div>
      </div>
      <button id="menu-toggle" class="hamburguesa">â˜°</button>
    </div>
  </header>

  <main class="admin-container">
    <div class="admin-header">
      <h2>ğŸ“Š Dashboard de Solicitudes</h2>
      <p>VisualizaciÃ³n de solicitudes recibidas a travÃ©s del formulario web</p>
    </div>

    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-number" id="total-solicitudes">0</div>
        <div>Total Solicitudes</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="solicitudes-hoy">0</div>
        <div>Solicitudes Hoy</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="reportes">0</div>
        <div>Reportes de AverÃ­a</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="consultas">0</div>
        <div>Consultas</div>
      </div>
    </div>

    <div style="margin-bottom: 20px;">
      <button class="btn-refresh" onclick="cargarSolicitudes()">
        ğŸ”„ Actualizar Datos
      </button>
      <a href="https://docs.google.com/spreadsheets/d/1xfq-c7OGWUhAZGR4KFbqSiBlRm1Epos7oLpWJ2dpPKs/edit" 
         target="_blank" 
         style="margin-left: 10px; padding: 10px 15px; background: #4285f4; color: white; text-decoration: none; border-radius: 5px;">
        ğŸ“Š Ver en Google Sheets
      </a>
    </div>

    <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
      <h3>ğŸ“‹ Ãšltimas Solicitudes</h3>
      <table id="solicitudes-table">
        <thead>
          <tr>
            <th>Ticket</th>
            <th>Fecha</th>
            <th>Nombre</th>
            <th>Tipo</th>
            <th>Estado</th>
          </tr>
        </thead>
        <tbody id="solicitudes-body">
          <!-- Datos cargados por JavaScript -->
        </tbody>
      </table>
      <div id="loading" style="text-align: center; padding: 20px;">
        â³ Cargando datos...
      </div>
      <div id="no-data" style="display: none; text-align: center; padding: 20px; color: #666;">
        No hay solicitudes registradas aÃºn.
      </div>
    </div>

    <div style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 10px;">
      <h3>ğŸ“ Instrucciones para el administrador:</h3>
      <ul>
        <li>Las solicitudes se guardan automÃ¡ticamente en <a href="https://docs.google.com/spreadsheets/d/1xfq-c7OGWUhAZGR4KFbqSiBlRm1Epos7oLpWJ2dpPKs/edit" target="_blank">Google Sheets</a></li>
        <li>Cada solicitud genera un correo a: <strong>consorcio.cucuta@gmail.com</strong></li>
        <li>Usa el botÃ³n "Actualizar Datos" para ver nuevas solicitudes</li>
        <li>Para editar contenido del sitio, contactar al desarrollador</li>
      </ul>
    </div>
  </main>

  <footer class="site-footer">
    <div class="footer-inner">
      <div class="footer-col">
        <h4>Panel de AdministraciÃ³n</h4>
        <p>VersiÃ³n 1.0 Â· Solo para uso interno</p>
      </div>
    </div>
    <div class="footer-bottom">
      <p>Â© 2025 Consorcio Interalumbrado de CÃºcuta Â· Acceso restringido</p>
    </div>
  </footer>

  <script>
  // Credenciales de acceso (simple)
  const ADMIN_PASSWORD = "Interalumbrado2025";
  
  function verificarAcceso() {
    const password = prompt("ğŸ” Ingrese la contraseÃ±a de administraciÃ³n:");
    if (password !== ADMIN_PASSWORD) {
      alert("Acceso denegado.");
      window.location.href = "index.html";
      return false;
    }
    return true;
  }
  
  if (!verificarAcceso()) {
    document.body.innerHTML = '<div style="padding: 50px; text-align: center;">Acceso denegado</div>';
  }
  
  // Cargar datos de Google Sheets (versiÃ³n simplificada)
  async function cargarSolicitudes() {
    document.getElementById('loading').style.display = 'block';
    document.getElementById('no-data').style.display = 'none';
    
    try {
      // Nota: Para una versiÃ³n real necesitarÃ­as API de Google Sheets
      // Esta es una versiÃ³n de demostraciÃ³n
      const solicitudes = JSON.parse(localStorage.getItem('interalumbrado_backups')) || [];
      
      if (solicitudes.length === 0) {
        document.getElementById('loading').style.display = 'none';
        document.getElementById('no-data').style.display = 'block';
        return;
      }
      
      // Actualizar estadÃ­sticas
      document.getElementById('total-solicitudes').textContent = solicitudes.length;
      document.getElementById('solicitudes-hoy').textContent = solicitudes.filter(s => {
        const hoy = new Date().toDateString();
        const fechaSolicitud = new Date(s.fecha).toDateString();
        return hoy === fechaSolicitud;
      }).length;
      
      document.getElementById('reportes').textContent = solicitudes.filter(s => 
        s.datos.tipo === 'reporte').length;
      
      document.getElementById('consultas').textContent = solicitudes.filter(s => 
        s.datos.tipo === 'consulta').length;
      
      // Mostrar tabla
      const tbody = document.getElementById('solicitudes-body');
      tbody.innerHTML = '';
      
      solicitudes.slice(-10).reverse().forEach(s => {
        const fecha = new Date(s.fecha).toLocaleString('es-CO');
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><span class="ticket-badge">${s.ticket || 'N/A'}</span></td>
          <td>${fecha}</td>
          <td>${s.datos.nombre || 'Sin nombre'}</td>
          <td>${s.datos.tipo === 'reporte' ? 'ğŸš¨ Reporte' : 'ğŸ“ Consulta'}</td>
          <td>ğŸŸ¡ Pendiente</td>
        `;
        tbody.appendChild(tr);
      });
      
      document.getElementById('loading').style.display = 'none';
      
    } catch (error) {
      console.error('Error cargando datos:', error);
      document.getElementById('loading').style.display = 'none';
      alert('Error cargando datos. Revisa la consola para mÃ¡s detalles.');
    }
  }
  
  // Cargar datos al iniciar
  document.addEventListener('DOMContentLoaded', cargarSolicitudes);
  </script>
  
  <script src="js/main.js" defer></script>
</body>
</html>